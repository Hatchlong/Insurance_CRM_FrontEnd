<app-side-nav (isShowNav)="handleSideBar($event)" [logoutAction]="idleState"></app-side-nav>
<div class="container-fluid " [ngStyle]="{'padding-left' : isShowPadding ? '280px' : '100px'}">
    <div class="row">
        <div class="col-12">
            <h3 class="py-2">
                <mat-icon class="back" routerLink="/master/vendor">arrow_back</mat-icon> Vendor Maintenance
            </h3>
            <form [formGroup]="vendorFormGroup" (ngSubmit)="submitData()">
                <div class="row">
                    <div class="col-12 border">
                        <div class="row">
                            <div class="col-6">
                                <div class="row">
                                    <div class="col-12 mt-2 py-2">
                                        <label for="VendorName">Vendor Name <sup>*</sup></label>
                                        <input type="text" class="form-control" formControlName="vendorName"
                                            placeholder="Enter Vendor Name">
                                        <div
                                            *ngIf="vendorFormGroup.controls['vendorName'].touched && vendorFormGroup.controls['vendorName'].dirty && vendorFormGroup.controls['vendorName'].hasError('required') && !isSubmitted">
                                            <p class="error-message">Vendor Name is mandatory</p>
                                        </div>
                                        <div
                                            *ngIf="isSubmitted && vendorFormGroup.controls['vendorName'].hasError('required')">
                                            <p class="error-message">Vendor Name is mandatory</p>
                                        </div>
                                    </div>
                                    <div class="col-12 py-2">
                                        <label for="">Vendor Type <sup>*</sup></label>
                                        <select class="form-select" formControlName="vendorTypeId" (change)="handleVendorType($event)">
                                            <option [selected]="vendorFormGroup.value.vendorTypeId === ''" value="" hidden>Select
                                                Vendor Type</option>
                                           <option *ngFor="let list of vendorTypeDetail;" [value]="list._id">{{list.description}}</option>
                                        </select>
                                        <div
                                            *ngIf="vendorFormGroup.controls['vendorTypeId'].touched && vendorFormGroup.controls['vendorTypeId'].dirty && vendorFormGroup.controls['vendorTypeId'].hasError('required') && !isSubmitted">
                                            <p class="error-message">Vendor Type is mandatory</p>
                                        </div>
                                        <div
                                            *ngIf="isSubmitted && vendorFormGroup.controls['vendorTypeId'].hasError('required')">
                                            <p class="error-message">Vendor Type is mandatory</p>
                                        </div>
                                    </div>
                                    <div class="col-12 py-2" [ngStyle]="{'pointer-events' : !vendorIdisShow ? 'none' : 'all' }" >
                                        <label for="">Vendor Id </label>
                                        <input type="text" class="form-control " formControlName="vendorId"
                                            placeholder="Enter Vendor Id" [readOnly]="!vendorIdisShow" >
                                    </div>
                                </div>
                            </div>
                            <div class="col-6 mt-2 py-2">
                                <label for="">Address <sup>*</sup></label>
                                <textarea name="" id="" cols="30" rows="{{vendorIdisShow ? 8 : 4}}" class="form-control"
                                    placeholder="Enter address" formControlName="addressCountry"></textarea>
                                <div
                                    *ngIf="vendorFormGroup.controls['addressCountry'].touched && vendorFormGroup.controls['addressCountry'].dirty && vendorFormGroup.controls['addressCountry'].hasError('required') && !isSubmitted">
                                    <p class="error-message">Address is mandatory</p>
                                </div>
                                <div
                                    *ngIf="isSubmitted && vendorFormGroup.controls['addressCountry'].hasError('required')">
                                    <p class="error-message">Address is mandatory</p>
                                </div>
                            </div>
                        </div>

                        <div class="row mb-2">
                            <div class="col-6 py-2">
                                <label for="">Country <sup>*</sup> </label>
                                <select class="form-select" formControlName="countryId" (change)="selectCountryName($event)">
                                    <option [selected]="vendorFormGroup.value.currency === ''" value="" hidden>Select Country</option>
                                    <option *ngFor="let list of countryDetails  | filterPipes:'countryName'" [value]="list._id">{{list.countryName}}</option>

                                </select>
                                <div
                                    *ngIf="vendorFormGroup.controls['countryId'].touched && vendorFormGroup.controls['countryId'].dirty && vendorFormGroup.controls['countryId'].hasError('required') && !isSubmitted">
                                    <p class="error-message">Country is mandatory</p>
                                </div>
                                <div *ngIf="isSubmitted && vendorFormGroup.controls['countryId'].hasError('required')">
                                    <p class="error-message">Country is mandatory</p>
                                </div>
                            </div>
                            <div class="col-6 py-2">
                                <label for="">Language <sup>*</sup></label>
                                <select class="form-select" aria-label="Default select example" formControlName="languageId"  >
                                    <option [selected]="vendorFormGroup.value.languageId === ''" value="" hidden>Select language</option>
                                    <option *ngFor="let list of languageDetails | filterPipes: 'languageCode'" [value]="list._id">{{list.languageCode}}</option>
                                </select>
                                <div    
                                    *ngIf="vendorFormGroup.controls['languageId'].touched && vendorFormGroup.controls['languageId'].dirty && vendorFormGroup.controls['languageId'].hasError('required') && !isSubmitted">
                                    <p class="error-message">Language is required</p>
                                </div>
                                <div *ngIf="isSubmitted && vendorFormGroup.controls['languageId'].hasError('required')">
                                    <p class="error-message">Language is required</p>
                                </div>
                            </div>
                             
                             <div class="col-6 py-2">
                                <label for="">Mode of transport <sup>*</sup></label>
                                <select class="form-select" formControlName="modeOfTransportId" (change)="handleMOT($event)">
                                    <option [selected]="vendorFormGroup.value.modeOfTransportId=== ''" value="" hidden>Select Mode Of Transport</option>
                                    <option *ngFor="let mot of motDetails | filterPipes:'modeOfTransport'" [value]="mot._id">{{mot.modeOfTransport}}</option>
     
                                </select>
                                <div
                                    *ngIf="vendorFormGroup.controls['modeOfTransportId'].touched && vendorFormGroup.controls['modeOfTransportId'].dirty && vendorFormGroup.controls['modeOfTransportId'].hasError('required') && !isSubmitted">
                                    <p class="error-message">Mode Of Transport is mandatory</p>
                                </div>
                                <div
                                    *ngIf="isSubmitted && vendorFormGroup.controls['modeOfTransportId'].hasError('required')">
                                    <p class="error-message">Mode Of Transport is mandatory</p>
                                </div>
                            </div>
                            <div class="col-6 py-2">
                                <label for="">Increment Terms<sup>*</sup></label>
                                <select class="form-select" formControlName="incrementTreamsId" (change)="handleInco($event)">
                                    <option [selected]="vendorFormGroup.value.incrementTreamsId=== ''" value="" hidden>Select Increment Treams</option>
                                    <option *ngFor="let inco of incoDetails| filterPipes:'inc_terms_code'" [value]="inco._id">{{inco.inc_terms_code}}</option>
                                </select>                               
                                <div
                                    *ngIf="vendorFormGroup.controls['incrementTreamsId'].touched && vendorFormGroup.controls['incrementTreamsId'].dirty && vendorFormGroup.controls['incrementTreamsId'].hasError('required') && !isSubmitted">
                                    <p class="error-message">Increment Terms is mandatory</p>
                                </div>
                                <div
                                    *ngIf="isSubmitted && vendorFormGroup.controls['incrementTreamsId'].hasError('required')">
                                    <p class="error-message">Increment Terms is mandatory</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row border mt-2">
                    <div class="col-12 ">
                        <div class="row">
                            <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6">
                                <h3 class="py-2">
                                    Financial Data
                                </h3>
                            </div>
                            <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 d-flex justify-content-end align-items-center">
                                <button class="btn btn-primary" type="button" (click)="addFinancial()">Add</button>
                            </div>
                        </div>

                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th *ngIf="financialListArray.controls.length > 1">Actions</th>
                                        <th>Tax Number</th>
                                        <th>VAT Registration No.</th>
                                        <th>Currency</th>
                                        <th>Company Code</th>
                                        <th>Bank Country</th>
                                        <th>Bank Key</th>
                                        <th>Bank Account</th>
                                        <th>Reference Details</th>
                                        <th>Account Holder</th>
                                        <th>Bank details Valid from</th>
                                        <th>Bank details Valid to</th>
                                        <th>Reconcilation account</th>
                                        <th>Payment method</th>
                                        <th>Payment terms</th>
                                    </tr>
                                </thead>
                                <tbody formArrayName="financialData">
                                    <tr *ngFor="let financial of financialListArray.controls; let i = index;"
                                        [formGroupName]="i">
                                        <td *ngIf="financialListArray.controls.length > 1">
                                            <mat-icon style="cursor:pointer"
                                                (click)="deleteFinancial(i)">delete</mat-icon>
                                        </td>
                                        <td>
                                            <input type="text" formControlName="taxNumber" class="form-control"
                                                placeholder="Enter Tax Number">
                                        </td>
                                        <td>
                                            <input type="text" formControlName="vatRegistrationNo" class="form-control"
                                                placeholder="Enter Vat Reg. No.">
                                        </td>
                                        <td>
                                            <select class="form-select " aria-label="Default select example" formControlName="currency" (change)="handleCurrency($event)" >
                                                <option [selected]="vendorFormGroup.value.currency===''" value="" hidden>Select Currency</option>
                                                <option *ngFor="let list of currencyDetails | filterPipes:'code' " [value]="list._id">{{list.code}}</option>
                                            </select>
                                          
                                        </td>
                                        <td>
                                            
                                            <select class="form-select" formControlName="companyCode" >
                                                <option [selected]="vendorFormGroup.value.companyCode=== ''" value="" hidden>Select Company Code</option>
                                                <option *ngFor="let company of companyCodeDetails | filterPipes:'companyCode' " [value]="company._id">{{company.companyCode}}</option>
                 
                                            </select>
                                          
                                        </td>
                                        <td>
                                                <select class="form-select" formControlName="bankCountry" (change)="selectCountryName($event)">
                                                    <option [selected]="vendorFormGroup.value.currency === ''" value="" hidden>Select Country</option>
                                                    <option *ngFor="let list of countryDetails | filterPipes:'countryName'" [value]="list._id">{{list.countryName}}</option>
                
                                                </select>
                                        </td>
                                        <td>
                                            <input type="text" formControlName="bankKey" class="form-control"
                                                placeholder="Enter Bank Key">
                                        </td>
                                        <td>
                                            <input type="text" formControlName="bankAccount" class="form-control"
                                                placeholder="Enter Bank Account">
                                        </td>
                                        <td>
                                            <input type="text" formControlName="referenceDetails" class="form-control"
                                                placeholder="Enter Reference Details">
                                        </td>
                                        <td>
                                            <input type="text" formControlName="accountHolder" class="form-control"
                                                placeholder="Enter Account Holder">
                                        </td>
                                        <td>
                                            <input type="date" formControlName="backDetailsValidFrom" class="form-control">
                                        </td>
                                        <td>
                                            <input type="date" formControlName="backDetailsValidTo" class="form-control">
                                        </td>
                                        <td>
                                            <select class="form-select" formControlName="reconciliationAccount"> 
                                                <option [selected]="vendorFormGroup.value.reconciliationAccount === '' " value="" hidden>Select Reconciliation Account</option>       
                                                <option *ngFor="let list of reconcilationAccountDetails | filterPipes:'description'" [value]="list._id">{{list.description}}</option>
                                            </select>
                                        </td>
                                        <td>

                                            
                                            <select class="form-select" formControlName="paymentMethod">   
                                                <option [selected]="vendorFormGroup.value.paymentMethod === ''" value="" hidden>Select Payment Method</option>
                                                <option *ngFor="let payment of paymentMethodDetails | filterPipes:'description'" [value]="payment._id">{{payment.description}}</option>
                                                
                                            </select>
                                        </td>
                                        <td>
                                            <select class="form-select" formControlName="paymentTerms">
                                    <option [selected]="vendorFormGroup.value.paymentTerms=== ''" value="" hidden>Select Payment Terms</option>
                                    <option *ngFor="let pay of payDetails | filterPipes:'paymentTerm'" [value]="pay._id">{{pay.paymentTerm}}</option>
                                </select> 
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row py-2">
                    <div class="col-12 d-flex justify-content-end">
                        <button class="btn btn-primary">Save</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>